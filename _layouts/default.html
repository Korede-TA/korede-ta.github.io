<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<link rel="stylesheet" href="../tachyons.min.css">
		<link rel="icon" href="../icon.png">
		<!--<script src="/color.js"></script>-->

		<script>
			(function() {
				var offset = Math.floor(Math.random() * Math.floor(360)); 
				// window.addEventListener('mousemove', scrollWheelHandler);
				window.setInterval(colorChangeHandler, 10);

				var globalColor;

				var canvasEngaged = false;

				function colorChangeHandler() {
					offset = (offset > 360) ? 0 : offset + 1 ;
					var color = "hsl("+offset.toString()+", 50%, 50%)";// alert(color);
					globalColor = color;
						try { document.getElementById("title").style.color = color; } catch {}
						try { document.getElementById("tilde").style.color = color; } catch {}
						try { document.getElementById("picture").style.backgroundColor = color; } catch {}
						try { document.getElementById("return").style.color = color; } catch {}
						try { document.getElementById("picture_canvas").style.backgroundColor = color; } catch {}
					// document.getElementsByClassName("link").map(function(link) { link.style.color = color; })
				}	

				document.addEventListener("DOMContentLoaded", function(event) {
					var canvas = document.getElementById("picture_canvas"),
						ctx = canvas.getContext("2d"),
						//line = new Line(ctx),
						img = new Image;
					canvas.width = 100;
					canvas.style.cursor = "pointer";

					img.onload = function() {
						ctx.imaegSmoothingQuality = "low";
						ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
					}
					img.src = "./no_eyes_2_jul_18_noalpha.png";

					//var pictureWidth = document.getElementById("picture").width;

					var mouseClicked = false;

					var pos = {x: 0, y: 0}; function setPos(e) { pos.x = e.clientX-canvas.offsetLeft; pos.y = e.clientY-canvas.offsetTop };

					function initDraw(e) {
						if (canvasEngaged === false) { // if canvas hasn't been engaged, engage it and do an animation of it growing
							canvas.style.cursor = "cell";

							canvas.style.animation = "shake 0.2s";
							canvas.style.animationIterationCount = "infinite";
							var intervalCallCount = 0;
							var interval = setInterval(function() {
								canvas.width  += 100;
								canvas.height += 100;
								ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

								if (++intervalCallCount === 4) {
									window.clearInterval(interval);
								}
							}, 500);
							canvasEngaged = true;
						}
						mouseClicked = true;
					}

				   function onDraw(e){
				   	if (canvasEngaged === false) { return; } // if canvas hasn't been engaged, ignore event
				   	// draw path
				   	if (mouseClicked === false) { return ;} 
				   	/* // alternate drawing code
				   		ctx.beginPath();
				   		ctx.lineCap = 'round';
				   		ctx.arc(e.clientX, e.clientY, 7.5, 0, Math.PI * 2, false);
				   		ctx.lineWidth = 5;
				   		ctx.strokeStyle = globalColor;
				   		ctx.stroke();
				   	*/

				   	ctx.beginPath(); // begin
				   	ctx.lineWidth = 5;
				   	ctx.lineCap = 'round';
				   	ctx.strokeStyle = globalColor;
				   	ctx.moveTo(pos.x, pos.y); // from
				   	setPos(e);
				   	ctx.lineTo(pos.x, pos.y); // to
				   	ctx.stroke();
				   }

					function stopDraw(e) {
						if (canvasEngaged === false) { return; } // if canvas hasn't been engaged, ignore event
						// stop drawing 
						mouseClicked = false;
					}

					canvas.addEventListener("mousedown", function (e) { e.preventDefault(); initDraw(e); }, false);

					canvas.addEventListener("mousemove", onDraw, false);
					canvas.addEventListener("touchmove", function (e) { e.preventDefault(); onDraw(e); }, false);

					canvas.addEventListener("mouseup", stopDraw, false);
					canvas.addEventListener("mouseout", stopDraw, false);
					canvas.addEventListener("touchend", function (e) { e.preventDefault(); stopDraw(e); }, false);
				});

			})();
		</script>
	</head>
	<body class="content bg-white near-black">
		<div class="courier ma3 ma6-ns mt6 mw7">
			{% if page.post %}
				<a id="return" href="/" class="no-underline">
					<h2>
						<img src="../twit_pic_apr_18_gif.gif" class="dib dim" height="30"> agbalumo.co
					</h2>
				</a>
			{% endif %}
			{{ content }}
			<p id="tilde" class="fw8 i f3">~</p>

			<!--<a class="log_link" href="https://www.notion.so/log-drafts-bbd9fba375e042ffba0d18ab195b4467">
				<h4>Log</h4>
			</a>-->

			<!-- <h4>Rants</h4>
			<ul class="list">
				{% for post in site.posts %}
					<li>
						<a href="{{ post.url }}"> {{ post.title }} </a>
					</li>
					<br/>
				{% endfor %}
			</ul>
			-->
		</div>
	</body>
</html>
